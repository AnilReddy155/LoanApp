package com.cg.service;

import java.sql.Timestamp;
import java.time.Instant;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.cg.entity.CustomerApproval;
import com.cg.model.CustomerDTO;
import com.cg.repo.CustomerApprovalRepository;

@Service
public class CustomerApprovalService {

    @Autowired
    private CustomerApprovalRepository customerApprovalRepository;
    
    public void processForApproval(CustomerDTO customerDTO) {
    	CustomerApproval customerApproval = new CustomerApproval();
    	customerApproval.setCustomerId(customerDTO.getId());
    	customerApproval.setStatus("PENDING");
    	customerApproval.setAdminId(1L); //this can be configured that which admin should review this account.
    	customerApproval.setCreatedAt(Timestamp.from(Instant.now()));
    	customerApproval.setUpdatedAt(Timestamp.from(Instant.now()));
    	
    	
    	customerApprovalRepository.save(customerApproval);
    }

    public CustomerApproval createCustomerApproval(CustomerApproval customerApproval) {
        return customerApprovalRepository.save(customerApproval);
    }

    public Optional<CustomerApproval> getCustomerApprovalById(Long id) {
        return customerApprovalRepository.findById(id);
    }

    public CustomerApproval updateCustomerApproval(CustomerApproval customerApproval) {
        if (customerApprovalRepository.existsById(customerApproval.getId())) {
            return customerApprovalRepository.save(customerApproval);
        }
        throw new RuntimeException("Customer Approval not found");
    }

    public void deleteCustomerApproval(Long id) {
        if (customerApprovalRepository.existsById(id)) {
            customerApprovalRepository.deleteById(id);
        } else {
            throw new RuntimeException("Customer Approval not found");
        }
    }

}
